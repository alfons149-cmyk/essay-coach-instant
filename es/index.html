<!doctype html>
<html lang="es" data-theme="coral">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title data-i18n="app.title">EssayCoach – Instant</title>

  <!-- Reuse parent assets -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="../assets/styles.css" />

  <!-- Tiny i18n loader -->
  <script>
  (function () {
    async function loadI18n(lang, basePath) {
      try {
        const res = await fetch(`${basePath}/assets/i18n/${lang}.json`, { cache: 'no-store' });
        const dict = await res.json();

        // Replace text content
        document.querySelectorAll('[data-i18n]').forEach(el => {
          const key = el.getAttribute('data-i18n');
          if (dict[key]) el.textContent = dict[key];
        });

        // Attributes (placeholders, titles)
        document.querySelectorAll('[data-i18n-title]').forEach(el => {
          const key = el.getAttribute('data-i18n-title');
          if (dict[key]) el.setAttribute('title', dict[key]);
        });
        document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
          const key = el.getAttribute('data-i18n-placeholder');
          if (dict[key]) el.setAttribute('placeholder', dict[key]);
        });

        // Simple templating helper: EC_t("io.input_words", { n: 123 })
        window.EC_t = (key, vars = {}) => {
          let s = dict[key] || key;
          for (const k in vars) s = s.replaceAll(`{${k}}`, String(vars[k]));
          return s;
        };

        document.documentElement.lang = lang;
      } catch (e) {
        console.error('i18n load error', e);
      }
    }

    const isSpanish = location.pathname.includes('/essay-coach-instant/es/');
    const lang = isSpanish ? 'es' : 'en';
    const basePath = isSpanish ? '/essay-coach-instant' : '';
    loadI18n(lang, basePath);
  })();
  </script>
</head>

<body>
  <!-- Language switch -->
  <nav class="lang-switch" style="margin:12px 0">
    <a href="/essay-coach-instant/" data-i18n="nav.english_ui">English</a> |
    <a href="/essay-coach-instant/es/" data-i18n="nav.spanish_ui">Español</a>
  </nav>

  <!-- Hero / overview -->
  <header>
    <h1 data-i18n="app.title">EssayCoach – Instant</h1>
    <p class="hint" data-i18n="home.hero_line">
      Andamiajes • Corrector (B2–C2) • Notas del entrenador • Resaltados y saltos • Reglas de puntuación • Guía y ejemplo • PDF
    </p>
  </header>

  <!-- Tabs -->
  <nav class="tabs" style="margin:8px 0 16px">
    <a href="#scaffolds" data-i18n="tabs.scaffolds">Andamiajes</a> •
    <a href="#corrector" data-i18n="tabs.corrector">Corrector</a> •
    <a href="#punct" data-i18n="tabs.punct_rules">¿Reglas de puntuación? Parte 2 (Carta/Email • Propuesta • Informe • Reseña)</a>
  </nav>

  <!-- === Scaffolds === -->
  <section id="scaffolds">
    <h2 data-i18n="tabs.scaffolds">Andamiajes</h2>

    <div class="controls">
      <label for="levelSel" data-i18n="label.level">Nivel</label>
      <div id="levelSel">
        <label><input type="radio" name="level" value="b2"> <span data-i18n="level.b2">B2 First</span></label>
        <label><input type="radio" name="level" value="c1"> <span data-i18n="level.c1">C1 Advanced</span></label>
        <label><input type="radio" name="level" value="c2"> <span data-i18n="level.c2">C2 Proficiency</span></label>
      </div>

      <label for="taskType" data-i18n="label.task_type">Tipo de tarea</label>
      <select id="taskType">
        <option value="essay" data-i18n="task.essay">Ensayo</option>
        <option value="report" data-i18n="task.report">Informe</option>
        <option value="review" data-i18n="task.review">Reseña</option>
        <option value="letter_email" data-i18n="task.letter_email">Carta / Email</option>
        <option value="proposal" data-i18n="task.proposal">Propuesta</option>
      </select>

      <div class="task-setup">
        <div class="title" data-i18n="label.task_setup">Preparación de la tarea</div>
      </div>
    </div>

    <div class="actions">
      <button id="btnCopyScaffold" data-i18n="btn.copy_scaffold">Copiar andamiaje</button>
      <button id="btnCopyOpener" data-i18n="btn.copy_opener">Copiar apertura</button>
      <button id="btnExportScaffoldPDF" data-i18n="btn.export_scaffold_pdf">Exportar andamiaje en PDF</button>
      <button id="btnGuideExample" data-i18n="btn.guide_example">Guía y ejemplo</button>
      <span class="hint" data-i18n="guide.about">
        “Guía y ejemplo” muestra una respuesta modelo completa para el Nivel + Tipo de tarea seleccionados.
      </span>
    </div>

    <h3 data-i18n="section.structure">Estructura</h3>
    <h4 data-i18n="section.moves_title">Movimientos recomendados (estructura en 4 partes)</h4>
    <div id="movesList"></div>

    <h4 data-i18n="section.useful_opener">Apertura útil (ejemplo)</h4>
    <div id="usefulOpener"></div>

    <h4 data-i18n="section.tips">Consejos</h4>
    <p class="hint" data-i18n="hint.choose_level">
      Elige nivel y tipo de tarea para actualizar el andamiaje.
    </p>

    <p class="reminder" data-i18n="reminder.essay_counts">
      Recordatorios para el ensayo: B2 140–190 • C1 220–260 • C2 240–280.
    </p>
  </section>

  <!-- === Corrector === -->
  <section id="corrector">
    <h2 data-i18n="tabs.corrector">Corrector</h2>

    <div class="status-row">
      <span id="inputWords" data-i18n="io.input_words">Entrada: {n} palabras</span> •
      <span id="outputWords" data-i18n="io.output_words">Salida: {n} palabras</span> •
      <span id="targetHint" data-i18n="io.target_example_c1">Objetivo 220–260 (ensayo C1)</span>
    </div>

    <div class="toggles">
      <label><input type="checkbox" id="enforceFormal"> <span data-i18n="controls.enforce_formal">Forzar registro formal</span></label><br />
      <label><input type="checkbox" id="useAI"> <span data-i18n="controls.use_ai">Usar IA (ChatGPT) con estilo alineado al examen</span></label><br />
      <label><input type="checkbox" id="showCoach"> <span data-i18n="controls.show_coach_notes">Mostrar notas del entrenador</span></label>
    </div>

    <div class="io">
      <div class="io-col">
        <div class="io-title" data-i18n="io.input_label">Entrada</div>
        <textarea id="userInput" rows="10" data-i18n-placeholder="io.input_label"></textarea>
      </div>
      <div class="io-col">
        <div class="io-title" data-i18n="io.output_label">Salida</div>
        <textarea id="correctedOutput" rows="10" readonly></textarea>
      </div>
    </div>

    <div class="actions">
      <button id="btnCorrect" data-i18n="btn.correct">Corregir</button>
      <button id="btnExportPDF" data-i18n="btn.export_pdf">Exportar PDF</button>
      <button id="btnClear" data-i18n="btn.clear">Limpiar</button>
      <button id="btnPaste" data-i18n="btn.paste">Pegar</button>
      <button id="btnStartTimer" data-i18n="btn.start_timer">Iniciar temporizador</button>
      <span id="timerBadge" data-i18n="io.timer_dash">Temporizador: --:--</span>
    </div>
  </section>

  <!-- === Punctuation rules === -->
  <section id="punct">
    <div class="actions">
      <button id="btnCopyRules" data-i18n="punct.copy_rules">Copiar reglas</button>
      <button id="btnExportRulesPDF" data-i18n="punct.export_rules_pdf">Exportar reglas en PDF</button>
    </div>
    <h3 data-i18n="punct.core_rules_title">Reglas básicas de puntuación</h3>
    <div id="punctRules"><em data-i18n="punct.placeholder">Coloca aquí tus reglas.</em></div>
  </section>

  <!-- === Part 2 corrector === -->
  <section id="part2">
    <h2 data-i18n="part2.corrector_title">Corrector de la Parte 2</h2>

    <div class="controls">
      <label data-i18n="part2.level">Nivel</label>
      <div>
        <label><input type="radio" name="p2level" value="b2"> <span data-i18n="level.b2">B2 First</span></label>
        <label><input type="radio" name="p2level" value="c1"> <span data-i18n="level.c1">C1 Advanced</span></label>
        <label><input type="radio" name="p2level" value="c2"> <span data-i18n="level.c2">C2 Proficiency</span></label>
      </div>
    </div>
  </section>

  <!-- Reuse app bundle -->
  <script src="../assets/app.bundle.js" defer></script>
</body>
</html>
