<!doctype html>
<html data-theme="coral" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EssayCoach – Cambridge Toolkit (Unified EN/ES)</title>

  <link rel="icon" type="image/png" sizes="192x192" href="./icon-192.png">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=IBM+Plex+Serif:wght@400;600&display=swap" rel="stylesheet">
  <!-- inside <head> -->
<!-- inside <head> -->
<link rel="stylesheet" href="./01-css/style.css">

<!-- Head scripts (externalized) -->
<script defer src="./03-js/i18n.js"></script>
<script defer src="./03-js/config.js"></script>

<!-- Libraries loaded in head -->
<script defer src="./03-js/ec_sentences.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>

<!-- Libraries loaded in head -->
<script defer src="./03-js/ec_sentences.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>

</head>

<body>
  <header>
    <div class="headerbar">
      <div>
        <h1 data-i18n="app.title">EssayCoach – Cambridge Toolkit</h1>
      </div>

      <div class="row" style="gap:8px">
        <nav aria-label="Language switch">
          <a href="?lang=en" data-i18n="nav.english">English</a> |
          <a href="?lang=es" data-i18n="nav.spanish">Español</a>
        </nav>
        <span id="quotaPill" class="pill">0/20</span>
        <div id="accountMenu"></div>
      </div>
    </div>

    <div id="trialBanner" class="hidden" style="margin:8px 0;padding:10px 12px;border:1px solid #f59e0b;background:#fff7ed;color:#7c2d12;border-radius:10px">
      <strong data-i18n="trial.expiringSoon">Trial ending soon</strong>
      <span id="trialBannerMsg" style="margin-left:8px"></span>
    </div>
  </header>

  <main class="grid">
    <!-- PAYWALL -->
    <section id="paywall" class="card hidden center">
      <h2 data-i18n="paywall.title">Subscribe to use the corrector</h2>
      <p class="muted" data-i18n="paywall.desc">Unlimited corrections, PDF export, and analyzer.</p>
      <div class="row center" style="justify-content:center">
        <button id="btnGoPricing" class="btn-primary" data-i18n="paywall.seePlans">See plans</button>
        <button id="btnStartTrial" class="btn-ghost" data-i18n="paywall.startTrial">Start 2-day trial</button>
      </div>
    </section>

    <!-- PRICING -->
    <section id="pricing" class="card hidden">
      <h2 data-i18n="pricing.title">Plans</h2>
      <ul>
        <li><strong data-i18n="pricing.monthly.name">Monthly</strong> — <span data-i18n="pricing.monthly.price">€15</span> <span class="muted" data-i18n="pricing.monthly.note">per month, auto-renews until cancelled</span></li>
        <li><strong data-i18n="pricing.exam.name">Exam Pack (6 months)</strong> — <span data-i18n="pricing.exam.price">€75</span> <span class="muted" data-i18n="pricing.exam.note">one-time, auto-expires</span></li>
      </ul>
      <div class="row">
        <button id="btnChooseMonthly" class="btn-primary" data-i18n="pricing.chooseMonthly">Choose Monthly</button>
        <button id="btnChooseExam" class="btn-ghost" data-i18n="pricing.chooseExam">Choose Exam Pack</button>
      </div>
    </section>

    <!-- APP BODY -->
    <section id="appBody" class="grid">
      <section id="corrector" class="card">
        <h2 data-i18n="corrector.title">AI Essay Corrector</h2>
        <div class="toolbar">
          <button id="btnCorrect" class="btn-primary" data-i18n="buttons.correct">Correct</button>
          <button id="btnExportPDF" class="btn-ghost" data-i18n="buttons.exportPdf">Export PDF</button>
          <button id="btnUndo" class="btn-ghost" disabled>Undo</button>
          <button id="btnClear" class="btn-ghost" data-i18n="buttons.clear">Clear</button>
          <button id="btnPaste" class="btn-ghost" data-i18n="buttons.paste">Paste</button>
          <button id="btnTimer" class="btn-ghost" data-i18n="buttons.startTimer">Start timer</button>
        </div>

        <div class="row">
          <label class="toggle"><input type="checkbox" id="tgFormal" checked> <span data-i18n="toggles.formalTone">Formal tone</span></label>
          <label class="toggle"><input type="checkbox" id="tgCoachNotes" checked> <span data-i18n="toggles.coachNotes">Coach notes</span></label>
          <label class="toggle"><input type="checkbox" id="tgRubric" checked> <span data-i18n="toggles.rubricPoints">Rubric points</span></label>
        </div>

        <!-- Level & Task selectors -->
        <div class="row">
          <label class="toggle">
            <span style="margin-right:6px">Level</span>
            <select id="levelSelect">
              <option value="B2">B2 (First)</option>
              <option value="C1" selected>C1 (Advanced)</option>
              <option value="C2">C2 (Proficiency)</option>
            </select>
          </label>
          <label class="toggle" style="margin-left:12px">
            <span style="margin-right:6px">Task type</span>
            <select id="typeSelect">
              <option value="essay" selected>Essay (Part 1)</option>
              <option value="report">Report</option>
              <option value="proposal">Proposal</option>
              <option value="review">Review</option>
              <option value="letter">Letter/Email</option>
            </select>
          </label>
        </div>

        <!-- Task & Sources (conditioned by level/type) -->
        <details id="taskBox" style="margin:8px 0" open>
          <summary style="cursor:pointer"><strong>Task & Sources</strong></summary>

          <div class="row" style="margin-top:8px">
            <label class="stack" style="flex:1">
              <span id="lblTaskPrompt">Task prompt (paste exact instructions)</span>
              <textarea id="taskPrompt" rows="2" placeholder="Paste the task/question here…"></textarea>
            </label>
          </div>

          <!-- B2/C1 essay bullets -->
          <div id="taskBulletsArea" class="row" style="gap:8px; margin-top:8px; display:none">
            <label class="stack" style="flex:1">
              <span id="lblTaskBullets">Task bullet points (one per line)</span>
              <textarea id="taskBullets" rows="2" placeholder="e.g. education&#10;transport&#10;healthcare"></textarea>
            </label>
            <label class="stack" style="flex:1">
              <span id="lblTaskSelected">Bullet points you chose (comma-separated)</span>
              <input id="taskSelected" placeholder="e.g. education, transport" />
            </label>
          </div>

          <!-- C2 essay sources -->
          <div id="taskSourcesArea" class="row" style="gap:8px; margin-top:8px; display:none">
            <label class="stack" style="flex:1">
              <span id="lblSourceA">Source text A (≈100 words)</span>
              <textarea id="taskSourceA" rows="3" placeholder="Paste source A"></textarea>
            </label>
            <label class="stack" style="flex:1">
              <span id="lblSourceB">Source text B (≈100 words)</span>
              <textarea id="taskSourceB" rows="3" placeholder="Paste source B"></textarea>
            </label>
          </div>
        </details>

        <textarea id="essayIn" placeholder="Paste your essay here…"></textarea>
        <div id="essayOut" class="preview" aria-live="polite"></div>
        <div class="hint" data-i18n="corrector.hint">The output mirrors Cambridge descriptors. Toggle options above to customise.</div>
      </section>

      <section id="sentences" class="card">
        <h2 data-i18n="sentences.title">Sentence-Type Analysis (simple / compound / complex / compound–complex)</h2>
        <div id="sentenceAnalysis" class="preview"></div>
        <div class="hint" data-i18n="sentences.hint">Hover or focus a sentence to see why it was classified.</div>
      </section>

      <section id="punct" class="card">
        <h2 data-i18n="punct.header">Core Punctuation Rules (Exam-Safe)</h2>
        <div class="toolbar">
          <button id="btnCopyRules" class="btn-ghost" data-i18n="buttons.copyRules">Copy rules</button>
          <button id="btnExportRules" class="btn-ghost" data-i18n="buttons.exportRules">Export rules as PDF</button>
        </div>
        <div id="punctList" class="preview"></div>
      </section>

      <section id="part2" class="card">
        <h2 data-i18n="part2.title">Part 2 quick rubric – genre checks</h2>
        <div id="part2Rubric" class="preview"></div>
      </section>
    </section>
  </main>

  <!-- PDF libs (defer; used on demand by app.js) -->
  <script defer src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

 <!-- App (all logic moved out of inline) -->
<script defer src="./03-js/app.js"></script>

</body>
</html>

