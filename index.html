<!doctype html>
<html lang="en" data-theme="coral">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title data-i18n="meta.title">EssayCoach â€“ Cambridge Toolkit (EN)</title>

  <!-- Developer-only mobile preview: ?mobile=1 adds "force-mobile" class -->
  <script>
    (function () {
      try {
        const qp = new URLSearchParams(window.location.search);
        if (qp.get("mobile") === "1") {
          document.documentElement.classList.add("force-mobile");
          console.log("[DEV] Mobile preview mode ON (force-mobile).");
        }
      } catch (e) {
        console.warn("[DEV] Mobile preview mode init failed:", e);
      }
    })();
  </script>

  <!-- GitHub Pages base (project pages) -->
  <base href="/essay-coach-instant/">

  <!-- Icons -->
  <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
  <link rel="apple-touch-icon" href="icon-192.png">
  <meta name="theme-color" content="#111111" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=IBM+Plex+Serif:wght@400;600&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="css/style.css">

  <!-- App scripts (order matters) -->
  <script defer src="js/i18n.js"></script>
  <script defer src="js/config.js"></script>
  <script defer src="js/cambridge_rubric.js"></script>
  <script defer src="js/scoring.js"></script>
  <script defer src="js/app.js"></script>

  <!-- Tiny debug guard for i18n -->
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      if (typeof window.I18N === 'undefined') {
        console.error('[i18n] window.I18N is missing. Check js/i18n.js path/name.');
      }
    });
  </script>

  <!-- (Optional) dev mobile flag again â€“ you could remove this duplicate if you like -->
  <script>
    (function () {
      const qp = new URLSearchParams(location.search);
      if (qp.get("mobile") === "1") {
        document.documentElement.classList.add("force-mobile");
      }
    })();
  </script>
</head>

<body>

  <!-- ðŸ”¹ Landing page â€“ shown first -->
  <section id="landing-hero" class="landing">
    <div class="landing-inner">
      <header class="landing-header">
        <h1 class="landing-title">EssayCoach â€” Your Personal Cambridge Writing Teacher</h1>
        <p class="landing-subtitle">
          Train for B2, C1, and C2 essays with instant, Cambridge-style feedback â€” any time, as often as you like.
        </p>
        <div class="landing-wave">
    <svg viewBox="0 0 1440 320" preserveAspectRatio="none">
      <path
        d="M0,96L60,106.7C120,117,240,139,360,160C480,181,600,203,720,192C840,181,960,139,1080,122.7C1200,107,1320,117,1380,122.7L1440,128L1440,0L1380,0C1320,0,1200,0,1080,0C960,0,840,0,720,0C600,0,480,0,360,0C240,0,120,0,60,0L0,0Z"
      ></path>
    </svg>
  </div>
      </header>

      <div class="landing-grid">
        <div class="landing-column">
          <h2>Why this app?</h2>
          <p>
            These days, many people practise writing essays using AI. Thatâ€™s fine â€” but AI will *not* sit next to you
            in the exam room. When you face the real Cambridge paper, <strong>you</strong> have to do everything yourself.
          </p>
          <p>
            You also donâ€™t learn to write strong exam essays in a single evening. It takes practice and a clear idea of
            what Cambridge expects at each level.
          </p>
        </div>

        <div class="landing-column">
          <h2>What EssayCoach gives you</h2>
          <ul class="landing-list">
            <li><strong>Instant feedback</strong> on your essays â€” in under a minute.</li>
            <li>Corrections and comments based on the <strong>Cambridge writing scale</strong>.</li>
            <li>A full <strong>Course Book</strong> with all the rules, patterns, and examples you need.</li>
            <li>Support for <strong>B2, C1, and C2 essays</strong> in one place.</li>
            <li><strong>Unlimited practice</strong> â€” no limits on how many essays you submit.</li>
            <li>Available <strong>24/7</strong>, whenever you decide to train.</li>
          </ul>
        </div>
      </div>

      <div class="landing-cta">
        <button class="btn-primary cta-button" data-start-app>
          Start practising your essays now
        </button>
        <p class="landing-note">
          No sign-up required. Paste a task, write your essay, and get feedback in less than a minute.
        </p>
      </div>
    </div>
  </section>
  <div class="landing-inner">
    <!-- you can put your existing intro here -->
    <h1 class="landing-title">
      Your personal Cambridge essay coach â€“ powered by AI, trained by a real teacher.
    </h1>

    <p class="landing-subtitle">
      Practise unlimited B2 / C1 / C2 essays, get instant Cambridge-style feedback, and learn the exact writing
      rules examiners use â€“ any time, anywhere.
    </p>

  <!-- ðŸ”¹ App root â€“ hidden until user clicks the CTA -->
  <div id="app-root" class="app-container" hidden>
    <noscript>This app requires JavaScript to run.</noscript>

    <!-- Top bar -->
    <header class="topbar">
      <div class="topbar-row">
        <h1 class="app-title" data-i18n="app.name">EssayCoach</h1>

        <div class="topbar-right">
          <!-- Language buttons -->
          <button class="btn-ghost" data-lang="en" title="English" data-i18n-title="tooltips.lang_en">EN</button>
          <button class="btn-ghost" data-lang="es" title="EspaÃ±ol" data-i18n-title="tooltips.lang_es">ES</button>
          <button class="btn-ghost" data-lang="nl" title="Nederlands" data-i18n-title="tooltips.lang_nl">NL</button>

          <!-- Open the Course Book (TOC) in a new tab -->
          <button
            class="btn-ghost"
            id="btnCourseBook"
            type="button">
            ðŸ“˜ <span data-i18n="labels.course_book">Read the Course Book</span>
          </button>

          <!-- API/dev badges -->
          <span class="badge" id="apiMode" style="margin-left:8px"></span>
          <span class="badge" id="devBadge" style="display:none">DEV</span>
        </div>
      </div>
    </header>

    <!-- Expertise tagline -->
    <div class="expert-tagline" data-i18n="app.tagline">
      Built on 25 years of Cambridge exam classroom experience.
    </div>

    <!-- Centered level row -->
    <div class="level-row">
      <span data-i18n="labels.level">Level:</span>
      <button type="button" class="pill" data-level="B2">B2</button>
      <button type="button" class="pill pill--active" data-level="C1">C1</button>
      <button type="button" class="pill" data-level="C2">C2</button>
    </div>

    <main class="app-main">
      <!-- Inputs -->
      <section class="grid-2">
        <div class="card">
          <div class="card-title" data-i18n="labels.prompt">Task prompt</div>
          <textarea id="task" rows="3" data-i18n-ph="placeholders.task"></textarea>
        </div>

        <div class="card">
          <div class="card-title" data-i18n="labels.essay">Your essay</div>
          <textarea id="essay" rows="12" data-i18n-ph="placeholders.essay"></textarea>
        </div>
      </section>

      <!-- Toolbar -->
      <section class="toolbar toolbar-row">
        <button id="btnCorrect" class="btn-primary"
                data-i18n="buttons.correct"
                title="Correct the essay"
                data-i18n-title="tooltips.correct">
          Correct
        </button>

        <button id="btnClear" class="btn-ghost"
                data-i18n="buttons.clear"
                title="Clear all fields"
                data-i18n-title="tooltips.clear">
          Clear
        </button>

        <!-- Word counters -->
        <div id="inWC"  class="pill" data-i18n="io.input_words">Input: {n} words</div>
        <div id="outWC" class="pill" data-i18n="io.output_words">Output: {n} words</div>
      </section>

      <!-- Advanced debug toggle -->
      <div class="debug-toggle-row">
        <button
          type="button"
          id="btnToggleDebug"
          class="btn-ghost debug-toggle"
          data-i18n="debug.show">
          Show advanced AI details
        </button>
      </div>

      <!-- Feedback + edits -->
      <section class="grid-2">
        <div class="card">
          <div class="card-title card-title--feedback" data-i18n="labels.feedback">
            Feedback
          </div>
          <div id="feedback" class="prose">â€”</div>
        </div>

        <div class="card">
          <div class="card-title" data-i18n="labels.edits">Edits</div>
          <ul id="edits" class="list"></ul>
        </div>
      </section>

      <section class="feedback-panel">
        <h2 class="feedback-panel__title">Course Book Help</h2>
        <div id="feedback-card">
          <!-- JS will render the card in here -->
        </div>
      </section>

      <!-- Cambridge band estimate -->
      <section class="card" id="bandsCard" hidden>
        <div class="card-title" data-i18n="bands.title">Estimated Cambridge band</div>

        <div class="row" style="gap:8px; align-items:center; flex-wrap:wrap;">
          <div class="pill">
            <strong data-i18n="bands.overall_score">Estimated score</strong>:
            <span id="bandsOverallScore">â€”</span>
          </div>
          <div class="pill">
            <strong data-i18n="bands.level_label">Exam level</strong>:
            <span id="bandsLevel">B2</span>
          </div>
        </div>

        <div style="margin-top:8px;">
          <strong data-i18n="bands.category_title">By criteria</strong>
          <ul id="bandsCategories" class="list"></ul>
        </div>

        <div style="margin-top:8px;">
          <strong data-i18n="bands.improvement_title">What to improve to go up a band</strong>
          <ul id="bandsImprovements" class="list"></ul>
        </div>

        <p style="margin-top:8px; font-size:0.85rem; opacity:0.8;" data-i18n="bands.disclaimer">
          This score is an estimate based on the Cambridge English Scale and not an official exam grade.
        </p>
      </section>

      <!-- Sentence insights (simple version) -->
      <section class="card" id="sentenceCard" hidden>
        <div class="card-title" data-i18n="sentences.title">
          Sentence insights from your essay
        </div>
        <p style="margin-top:4px; font-size:0.9rem; color:#2563eb;">
          ðŸ’¡ Read the unit in the Course Book that explains how this type of sentence works.
        </p>
        <ul id="sentenceList" class="list sentence-list"></ul>
      </section>

      <!-- Next draft -->
      <section class="card">
        <div class="card-title" data-i18n="labels.next_draft">Next draft</div>
        <textarea id="nextDraft" rows="10" data-i18n-ph="placeholders.next_draft"></textarea>
      </section>

      <!-- Vocabulary -->
      <section class="card" id="vocabCard" hidden>
        <div class="card-title" data-i18n="labels.vocab_options">Vocabulary options</div>
        <ul id="vocab" class="list"></ul>
      </section>

      <!-- Sentence insights (new structure card) -->
      <section class="card" id="sentencesCard" hidden>
        <div class="card-title" data-i18n="sentence.title">
          How your sentences are built
        </div>
        <ul id="sentencesList" class="list list--compact"></ul>
      </section>

      <!-- Paragraph insights -->
      <section class="card" id="paragraphCard" hidden>
        <div class="card-title" data-i18n="paragraph.title">
          Paragraph logic & structure
        </div>
        <ul id="paragraphInsights" class="list"></ul>
      </section>

      <!-- JSON debug viewer (advanced users) -->
      <section class="card" id="debugCard" hidden>
        <div class="card-title" data-i18n="debug.title">
          AI response (advanced details)
        </div>
        <pre id="debugJson" class="debug-json"></pre>
      </section>

    </main>

    <!-- Open the course book in a new tab -->
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const btn = document.getElementById('btnCourseBook');
        if (!btn) return;

        btn.addEventListener('click', () => {
          // open the new HTML book in a new tab
          window.open('assets/book/index.html', '_blank', 'noopener');
        });
      });
    </script>

    <!-- API/dev badges -->
    <script>
      (function () {
        const qs  = new URLSearchParams(location.search);
        const dev = qs.get('dev') === '1';
        const api = (window.EC && EC.API_BASE) ? 'live' : (dev ? 'mock' : 'auto');
        const apiEl = document.getElementById('apiMode');
        const devEl = document.getElementById('devBadge');
        if (apiEl) apiEl.textContent = api;
        if (devEl) devEl.style.display = dev ? 'inline' : 'none';
      })();
    </script>

    <!-- Feedback mapping + engine + UI (modules) -->
    <script type="module" src="feedback/mistake-map.js"></script>
    <script type="module" src="feedback/feedback-engine.js"></script>
    <script type="module" src="feedback/feedback-ui.js"></script>

    <!-- DO NOT add another app.js here; it already loads in <head> as js/app.js -->
  </div>

  <!-- ðŸ”¹ Tiny toggle script for landing â†’ app -->
  <script>
    (function () {
      const landing = document.getElementById("landing-hero");
      const appRoot = document.getElementById("app-root");
      const startBtn = document.querySelector("[data-start-app]");

      if (!landing || !appRoot || !startBtn) return;

      startBtn.addEventListener("click", () => {
        landing.style.display = "none";
        appRoot.hidden = false;
        window.scrollTo({ top: 0, behavior: "smooth" });
      });
    })();

    <div class="landing-cta">
      <button class="cta-button" data-start-app>
        Start practising my essays now
      </button>
      <p class="landing-note">
        No limits â€¢ Instant feedback â€¢ Based on real Cambridge classroom experience
      </p>
    </div>
  </div>
</section>
  </script>
</body>
</html>
